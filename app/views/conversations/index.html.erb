<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center">
    <h1>Messagerie</h1>
    <%= link_to new_conversation_path, class: "button button--primary" do %>
      <img src="/icons/send.svg" width="18" height="18" class="me-2" alt="">
      <span>Nouveau message</span>
    <% end %>
  </div>

  <% if @messages.any? %>
    <div class="list-group mt-4">
      <% @messages.each do |message| %>
        <%= link_to conversation_path(message), class: "list-group-item list-group-item-action" do %>
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <% if message.sender == current_user %>
                <strong>A :</strong> <%= message.recipients.map(&:first_name).join(", ") %>
              <% else %>
                <strong>De :</strong> <%= message.sender.first_name %>
              <% end %>
              <p class="mb-0 text-muted small mt-1"><%= truncate(message.content, length: 80) %></p>
            </div>
            <small class="text-muted"><%= message.created_at.strftime("%d/%m/%Y %Hh%M") %></small>
          </div>
        <% end %>
      <% end %>
    </div>
  <% else %>
    <p class="text-muted mt-4">Aucun message pour le moment.</p>
  <% end %>
</div>
